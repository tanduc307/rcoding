<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Thống kê sinh học: Từ lý thuyết đến ứng dụng - 9&nbsp; Hướng dẫn phân tích t-test trong R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./phan-tich-anova-2-yeu-to-trong-r.html" rel="next">
<link href="./khoang-tin-cay.html" rel="prev">
<link href="./favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./co-so-ly-thuyet.html">Cơ sở lý thuyết</a></li><li class="breadcrumb-item"><a href="./huong-dan-phan-tich-t-test-trong-r.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title"><b>Hướng dẫn phân tích t-test trong R</b></span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./"></a><a href="https://thongkesinhhoc.com/">Thống kê sinh học: Từ lý thuyết đến ứng dụng</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Giới thiệu</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./cac-lenh-do-thi-can-ban-su-dung-base-r-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Các lệnh đồ thị căn bản sử dụng Base R Graphics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./huong-dan-ve-do-thi-cot-base-r-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title"><b>Hướng dẫn vẽ đồ thị cột bằng Base R Graphics</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./huong-dan-cach-thay-doi-do-rong-cot-trong-barplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title"><b>Hướng dẫn cách thay đổi độ rộng cột trong barplot</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tinh-huong-base-r-graphics-thuong-gap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title"><b>Tình huống Base R Graphics thường gặp</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./huong-dan-ve-do-thi-nhieu-truc-y.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title"><b>Hướng dẫn vẽ đồ thị nhiều trục Y</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./huong-dan-ve-do-thi-bang-package-lattice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title"><b>Hướng dẫn vẽ đồ thị bằng package <code>lattice</code></b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./so-sanh-cu-phap-ve-do-thi-qua-cac-package-khac-nhau.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title"><b>So sánh cú pháp vẽ đồ thị trong R qua các package khác nhau</b></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./co-so-ly-thuyet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cơ sở lý thuyết</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tong-quan-tai-lieu.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title"><b>Tổng quan tài liệu</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./khoang-tin-cay.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title"><b>Khoảng tin cậy là gì?</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./huong-dan-phan-tich-t-test-trong-r.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title"><b>Hướng dẫn phân tích t-test trong R</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./phan-tich-anova-2-yeu-to-trong-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title"><b>Phân tích ANOVA 2 yếu tố trong R</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./so-sanh-ket-qua-giua-parametric-va-non-parametric-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title"><b>So sánh kết quả giữa phân tích parametric và non-parametric ANOVA</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./phan-tich-ancova-trong-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title"><b>Phân tích ANCOVA trong R</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cac-lenh-r-thuong-dung-khi-thuc-hien-thong-ke-mo-ta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title"><b>Các lệnh R thường dùng khi thực hiện thống kê mô tả</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quy-trinh-phan-tich-logistic-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title"><b>Quy trình phân tích logistic regression</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./khai-niem-bootstrap-qua-vi-du-tinh-trung-binh-mau.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title"><b>Khái niệm về bootstrap qua ví dụ tính trung bình mẫu</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bo-tri-thi-nghiem-toi-uu-hoa-bang-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title"><b>Bố trí thí nghiệm tối ưu hóa bằng R</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow-phan-tich-thong-ke-qua-dataset-iris.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title"><b>Workflow phân tích thống kê qua dataset <code>iris</code> </b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-partial-least-squares-and-principal-component-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title"><b>Example for Partial Least Squares and Principal Component Regression</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quy-cach-ghi-ky-hieu-toan-hoc-trong-cong-thuc-xac-suat-thong-ke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title"><b>Quy cách ghi ký hiệu toán học trong công thức xác suất thống kê</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tai-lieu-phan-tich-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title"><b>Tài liệu phân tích PCA</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./xay-dung-mo-hinh-GAM-trong-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title"><b>Xây dựng mô hình GAM trong R</b></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Kỹ thuật xử lý dữ liệu</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./huong-dan-convert-tu-csv-qua-tsv-trong-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title"><b>Hướng dẫn convert từ file <code>csv</code> qua <code>tsv</code> trong R</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./huong-dan-cach-lam-tron-so-trong-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title"><b>Hướng dẫn cách làm tròn số trong R</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./huong-dan-show-all-data-tren-console.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title"><b>Hướng dẫn show all data trên console</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ky-thuat-reshape-du-lieu.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title"><b>Kỹ thuật reshape dữ liệu</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ky-thuat-kiem-tra-missing-value.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title"><b>Kỹ thuật kiểm tra missing value <code>NA</code></b></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tài liệu tham khảo</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./co-so-ly-thuyet.html">Cơ sở lý thuyết</a></li><li class="breadcrumb-item"><a href="./huong-dan-phan-tich-t-test-trong-r.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title"><b>Hướng dẫn phân tích t-test trong R</b></span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title"><b>Hướng dẫn phân tích t-test trong R</b></span></h1>
</div>



<div class="quarto-title-meta column-page-right">

    
  
    
  </div>
  


</header>


<section id="bước-1-cơ-sở-lý-thuyết" class="level4" data-number="9.0.0.1">
<h4 data-number="9.0.0.1" class="anchored" data-anchor-id="bước-1-cơ-sở-lý-thuyết"><span class="header-section-number">9.0.0.1</span> <span style="color:blue"><strong>Bước 1: Cơ sở lý thuyết</strong></span></h4>
<p><code>https://www.jmp.com/en_ch/statistics-knowledge-portal/t-test.html</code></p>
<blockquote class="blockquote">
<p><mark style="background-color: #FFFF00"><strong>What is a t-test?</strong></mark></p>
<p>A t-test (also known as Student’s t-test) is a tool for evaluating the means of one or two populations using hypothesis testing. A t-test may be used to evaluate whether a single group differs from a known value (a one-sample t-test), whether two groups differ from each other (an independent two-sample t-test), or whether there is a significant difference in paired measurements (a paired, or dependent samples t-test).</p>
<p><mark style="background-color: #FFFF00"><strong>How are t-tests used?</strong></mark></p>
<p>First, you define the hypothesis you are going to test and specify an acceptable risk of drawing a faulty conclusion. For example, when comparing two populations, you might hypothesize that their means are the same, and you decide on an acceptable probability of concluding that a difference exists when that is not true. Next, you calculate a test statistic from your data and compare it to a theoretical value from a t-distribution. Depending on the outcome, you either reject or fail to reject your null hypothesis.</p>
<p><mark style="background-color: #FFFF00"><strong>What if I have more than two groups?</strong></mark></p>
<p>You cannot use a t-test. Use a multiple comparison method. Examples are analysis of variance (ANOVA), Tukey-Kramer pairwise comparison, Dunnett’s comparison to a control, and analysis of means (ANOM).</p>
</blockquote>
</section>
<section id="bước-2-đề-bài-về-so-sánh-hai-loài-hoa-qua-các-chỉ-tiêu-định-lượng-để-tìm-ra-sự-khác-biệt-bằng-kiểm-định-t-test" class="level4" data-number="9.0.0.2">
<h4 data-number="9.0.0.2" class="anchored" data-anchor-id="bước-2-đề-bài-về-so-sánh-hai-loài-hoa-qua-các-chỉ-tiêu-định-lượng-để-tìm-ra-sự-khác-biệt-bằng-kiểm-định-t-test"><span class="header-section-number">9.0.0.2</span> <span style="color:blue"><strong>Bước 2: Đề bài về so sánh hai loài hoa qua các chỉ tiêu định lượng để tìm ra sự khác biệt bằng kiểm định t-test</strong></span></h4>
<section id="bước-2.1-đặt-giả-thuyết-thống-kê-cho-kiểm-định-t-test-2-đuôi" class="level5" data-number="9.0.0.2.1">
<h5 data-number="9.0.0.2.1" class="anchored" data-anchor-id="bước-2.1-đặt-giả-thuyết-thống-kê-cho-kiểm-định-t-test-2-đuôi"><span class="header-section-number">9.0.0.2.1</span> <span style="color:green"><strong>Bước 2.1: Đặt giả thuyết thống kê cho kiểm định t-test 2 đuôi</strong></span></h5>
<ul>
<li><p><span class="math inline">\({H_0}\)</span> : Trung bình tổng thể giữa hai mẫu <em>không khác nhau</em> về chỉ tiêu quan tâm <span class="math inline">\(\mu_1 = \mu_2\)</span></p></li>
<li><p><span class="math inline">\({H_\alpha }\)</span> : Trung bình tổng thể giữa hai mẫu <em>khác nhau</em> về chỉ tiêu quan tâm <span class="math inline">\(\mu_1 \ne \mu_2\)</span></p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>flower <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"flower.csv"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>flower<span class="sc">$</span>Species <span class="ot">&lt;-</span> <span class="fu">factor</span>(flower<span class="sc">$</span>Species)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>flower </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   No.  Species   LBL  LBW  LBAR   LBC    PL   CTL   CLL
1    1 Flower A 11.00 3.30 3.663 0.616 0.770 0.220 0.352
2    2 Flower A  9.90 2.20 4.950 0.517 0.550 0.253 0.385
3    3 Flower A 10.45 2.75 4.180 0.572 0.605 0.275 0.385
4    4 Flower A 11.55 3.30 3.850 0.594 0.792 0.220 0.330
5    5 Flower A 12.10 3.85 3.454 0.627 0.825 0.231 0.352
6    6 Flower A 13.20 3.85 3.773 0.605 0.880 0.220 0.330
7    7 Flower A 13.20 4.40 3.300 0.649 0.880 0.253 0.418
8    8 Flower A  9.90 3.30 3.300 0.649 0.550 0.275 0.462
9    9 Flower A 11.55 3.85 3.300 0.649 0.825 0.242 0.440
10  10 Flower A 12.10 4.18 3.179 0.660 0.825 0.264 0.495
11  11 Flower A 13.20 4.40 3.300 0.649 0.825 0.242 0.440
12  12 Flower A 10.45 3.30 3.487 0.627 0.605 0.231 0.418
13  13 Flower A  9.90 2.20 4.950 0.517 0.550 0.220 0.330
14  14 Flower A 11.00 2.75 4.400 0.550 0.660 0.275 0.495
15  15 Flower A 12.10 3.85 3.454 0.627 0.814 0.275 0.495
16  16 Flower A 13.20 4.40 3.300 0.649 0.880 0.264 0.462
17  17 Flower A 12.76 4.07 3.454 0.638 0.825 0.242 0.451
18  18 Flower A 11.00 3.41 3.553 0.627 0.770 0.231 0.440
19  19 Flower A 11.44 3.85 3.267 0.649 0.792 0.253 0.440
20  20 Flower A  9.90 2.75 3.960 0.583 0.550 0.242 0.418
21  21 Flower A 11.77 3.85 3.366 0.638 0.715 0.231 0.385
22  22 Flower A 12.10 3.85 3.454 0.627 0.792 0.264 0.495
23  23 Flower A 12.65 4.18 3.333 0.649 0.825 0.242 0.440
24  24 Flower A 13.20 4.40 3.300 0.649 0.880 0.264 0.473
25  25 Flower A 11.66 3.52 3.641 0.616 0.748 0.231 0.418
26  26 Flower A 12.65 4.18 3.333 0.649 0.847 0.275 0.495
27   1 Flower B 12.10 3.52 3.784 0.605 0.660 0.110 0.880
28   2 Flower B 11.00 3.30 3.663 0.616 0.550 0.165 0.990
29   3 Flower B 11.55 3.30 3.850 0.594 0.550 0.220 1.210
30   4 Flower B 13.20 3.41 4.257 0.561 0.770 0.220 1.320
31   5 Flower B 13.20 3.41 4.257 0.561 0.715 0.132 0.990
32   6 Flower B 15.40 3.74 4.532 0.539 0.770 0.165 0.990
33   7 Flower B 15.40 3.52 4.818 0.528 0.770 0.198 1.100
34   8 Flower B 16.50 3.85 4.719 0.528 0.825 0.176 1.034
35   9 Flower B 16.50 3.74 4.851 0.517 0.880 0.209 1.320
36  10 Flower B 16.50 3.74 4.851 0.517 0.880 0.110 0.880
37  11 Flower B 14.30 3.52 4.466 0.550 0.660 0.132 0.935
38  12 Flower B 14.30 3.52 4.466 0.550 0.660 0.198 1.100
39  13 Flower B 13.75 3.41 4.433 0.550 0.616 0.176 1.045
40  14 Flower B 13.20 3.52 4.125 0.572 0.660 0.165 0.990
41  15 Flower B 12.65 3.30 4.213 0.572 0.605 0.209 1.320
42  16 Flower B 12.87 3.52 4.026 0.583 0.605 0.220 1.320
43  17 Flower B 14.30 3.30 4.763 0.528 0.660 0.220 1.320
44  18 Flower B 14.85 3.74 4.367 0.550 0.660 0.220 1.210
45  19 Flower B 15.95 3.85 4.554 0.539 0.792 0.187 1.100
46  20 Flower B 16.50 3.85 4.719 0.528 0.880 0.176 0.990</code></pre>
</div>
</div>
</section>
<section id="bước-2.2-thống-kê-mô-tả" class="level5" data-number="9.0.0.2.2">
<h5 data-number="9.0.0.2.2" class="anchored" data-anchor-id="bước-2.2-thống-kê-mô-tả"><span class="header-section-number">9.0.0.2.2</span> <span style="color:green"><strong>Bước 2.2: Thống kê mô tả</strong></span></h5>
<p>Thực hiện cho 1 chỉ tiêu <code>LBL</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>flower  <span class="ot">&lt;-</span> flower[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>flower <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(LBL, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fu">sd</span>(LBL, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(LBL, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">IQR =</span> <span class="fu">IQR</span>(LBL, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
  Species  count  mean    sd median   IQR
  &lt;fct&gt;    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 Flower A    26  11.7  1.14   11.7  1.65
2 Flower B    20  14.2  1.73   14.3  2.42</code></pre>
</div>
</div>
<p>Nếu thực hiện tính toán các chỉ số thống kê cho lần lượt các cột trong data frame thì ta sẽ áp dụng lệnh họ apply.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">### khi sử dụng function với các lệnh trong dplyr thì bạn cần lưu ý quote string tham số </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># https://shixiangwang.github.io/tidyeval-chinese/dplyr.html</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stackoverflow.com/questions/67382081/how-to-pass-column-name</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#-as-argument-to-function-for-dplyr-verbs</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>thong_ke_mo_ta <span class="ot">&lt;-</span> <span class="cf">function</span>(input, group_input, chi_tieu) {</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  input <span class="sc">|&gt;</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(.data[[group_input]]) <span class="sc">%&gt;%</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean =</span> <span class="fu">mean</span>(.data[[chi_tieu]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">sd =</span> <span class="fu">sd</span>(.data[[chi_tieu]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">median =</span> <span class="fu">median</span>(.data[[chi_tieu]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">IQR =</span> <span class="fu">IQR</span>(.data[[chi_tieu]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="ot">-&gt;</span> df_ok</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df_ok)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(<span class="fu">names</span>(flower)[<span class="sc">-</span><span class="dv">1</span>], <span class="at">FUN =</span> thong_ke_mo_ta,</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">input =</span> flower, <span class="at">group_input =</span> <span class="st">"Species"</span>) <span class="ot">-&gt;</span> ok</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ok) <span class="ot">&lt;-</span> <span class="fu">names</span>(flower)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>ok</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$LBL
# A tibble: 2 × 6
  Species  count  mean    sd median   IQR
  &lt;fct&gt;    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 Flower A    26  11.7  1.14   11.7  1.65
2 Flower B    20  14.2  1.73   14.3  2.42

$LBW
# A tibble: 2 × 6
  Species  count  mean    sd median   IQR
  &lt;fct&gt;    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 Flower A    26  3.61 0.655   3.85 0.852
2 Flower B    20  3.55 0.196   3.52 0.33 

$LBAR
# A tibble: 2 × 6
  Species  count  mean    sd median   IQR
  &lt;fct&gt;    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 Flower A    26  3.63 0.488   3.45 0.446
2 Flower B    20  4.39 0.361   4.45 0.528

$LBC
# A tibble: 2 × 6
  Species  count  mean     sd median    IQR
  &lt;fct&gt;    &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 Flower A    26 0.619 0.0404  0.627 0.0413
2 Flower B    20 0.554 0.0286  0.55  0.0440

$PL
# A tibble: 2 × 6
  Species  count  mean    sd median   IQR
  &lt;fct&gt;    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 Flower A    26 0.753 0.115  0.792 0.151
2 Flower B    20 0.708 0.106  0.66  0.127

$CTL
# A tibble: 2 × 6
  Species  count  mean     sd median    IQR
  &lt;fct&gt;    &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 Flower A    26 0.248 0.0195  0.242 0.033 
2 Flower B    20 0.180 0.0366  0.182 0.0467

$CLL
# A tibble: 2 × 6
  Species  count  mean     sd median   IQR
  &lt;fct&gt;    &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 Flower A    26 0.425 0.0544   0.44 0.077
2 Flower B    20 1.10  0.155    1.07 0.248</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">names</span>(flower)[<span class="sc">-</span><span class="dv">1</span>])){</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">histogram</span>( <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">"~"</span>, <span class="fu">names</span>(flower)[<span class="sc">-</span><span class="dv">1</span>][i], <span class="st">"|"</span>, <span class="st">"Species"</span>)), <span class="at">data =</span> flower,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">type =</span> <span class="st">"density"</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">panel =</span> <span class="cf">function</span>(x, ...) {</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>               <span class="fu">panel.histogram</span>(x, ...)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>               <span class="fu">panel.mathdensity</span>(<span class="at">dmath =</span> dnorm, <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean=</span><span class="fu">mean</span>(x),<span class="at">sd=</span><span class="fu">sd</span>(x)))</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>             } ))</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="huong-dan-phan-tich-t-test-trong-r_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="huong-dan-phan-tich-t-test-trong-r_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="huong-dan-phan-tich-t-test-trong-r_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="huong-dan-phan-tich-t-test-trong-r_files/figure-html/unnamed-chunk-5-4.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="huong-dan-phan-tich-t-test-trong-r_files/figure-html/unnamed-chunk-5-5.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="huong-dan-phan-tich-t-test-trong-r_files/figure-html/unnamed-chunk-5-6.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="huong-dan-phan-tich-t-test-trong-r_files/figure-html/unnamed-chunk-5-7.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="bước-3kiểm-tra-giả-thuyết-cho-t-test" class="level4" data-number="9.0.0.3">
<h4 data-number="9.0.0.3" class="anchored" data-anchor-id="bước-3kiểm-tra-giả-thuyết-cho-t-test"><span class="header-section-number">9.0.0.3</span> <span style="color:blue"><strong>Bước 3:Kiểm tra giả thuyết cho t-test</strong></span></h4>
<p><span style="background-color:dodgerblue; text-align:center;color:white;font-size:24px;"><strong>Từ chỗ này trở đi ta sẽ tính riêng chỉ tiêu “LBL” cho “Flower A” và “Flower B”. Các chỉ tiêu còn lại thực hiện tương tự.</strong></span></p>
<p><strong>Giả thuyết cho t-test 1 sample</strong></p>
<p>While t-tests are relatively robust to deviations from assumptions, t-tests do assume that:</p>
<ul>
<li><p>The data are continuous.</p></li>
<li><p>The sample data have been randomly sampled from a population.</p></li>
<li><p>The distribution is approximately normal.</p></li>
<li><p>There is homogeneity of variance (i.e., the variability of the data in each group is similar).</p>
<ul>
<li><p><mark>the standard Student’s t-test, which assumes that the variance of the two groups are equal.</mark></p></li>
<li><p><mark>the Welch’s t-test, which is less restrictive compared to the original Student’s test. This is the test where you do not assume that the variance is the same in the two groups, which results in the fractional degrees of freedom.</mark></p></li>
</ul></li>
</ul>
<p><strong>Giả thuyết cho t-test 2 sample</strong></p>
<p><code>https://www.jmp.com/en_is/statistics-knowledge-portal/t-test/two-sample-t-test.html</code></p>
<ul>
<li><p>For two-sample t-tests, we must have independent samples. If the samples are not independent, then a paired t-test may be appropriate. <span class="math inline">\(\Rightarrow\)</span> <mark style="background-color: #FFFF00">Trong dataset này thì đây là 2 mẫu độc lập, unpaired</mark></p></li>
<li><p>Data values must be independent. Measurements for one observation do not affect measurements for any other observation. <span class="math inline">\(\Rightarrow\)</span> <mark style="background-color: #FFFF00">OK</mark></p></li>
<li><p>Data in each group must be obtained via a random sample from the population. <span class="math inline">\(\Rightarrow\)</span> <mark style="background-color: #FFFF00">OK</mark></p></li>
<li><p>Data in each group are normally distributed.</p></li>
<li><p>Data values are continuous. <span class="math inline">\(\Rightarrow\)</span> <mark style="background-color: #FFFF00">OK</mark></p></li>
<li><p>The variances for the two independent groups are equal.</p></li>
</ul>
<section id="bước-3.1-thực-hiện-kiểm-tra-giả-thuyết-về-phân-bố-chuẩn" class="level5" data-number="9.0.0.3.1">
<h5 data-number="9.0.0.3.1" class="anchored" data-anchor-id="bước-3.1-thực-hiện-kiểm-tra-giả-thuyết-về-phân-bố-chuẩn"><span class="header-section-number">9.0.0.3.1</span> <span style="color:green"><strong>Bước 3.1: Thực hiện kiểm tra giả thuyết về phân bố chuẩn</strong></span></h5>
<p><span style="color:green"><strong>Cách 1: Sử dụng Q-Q plot</strong></span></p>
<p><strong>Q-Q plot cho theo từng group.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test cho toàn bộ các group</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># qqnorm(flower$LBL, pch = 1, frame = FALSE)</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># qqline(flower$LBL, col = "steelblue", lwd = 2)</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>flower <span class="sc">|&gt;</span> <span class="fu">subset</span>(Species <span class="sc">==</span> <span class="st">"Flower A"</span>) <span class="ot">-&gt;</span> flower_a</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(flower_a<span class="sc">$</span>LBL, <span class="at">pch =</span> <span class="dv">1</span>, <span class="at">frame =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">"Q-Q plot for Flower A"</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(flower_a<span class="sc">$</span>LBL, <span class="at">col =</span> <span class="st">"steelblue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>flower <span class="sc">|&gt;</span> <span class="fu">subset</span>(Species <span class="sc">==</span> <span class="st">"Flower B"</span>) <span class="ot">-&gt;</span> flower_b</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(flower_b<span class="sc">$</span>LBL, <span class="at">pch =</span> <span class="dv">1</span>, <span class="at">frame =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">"Q-Q plot for Flower B"</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(flower_b<span class="sc">$</span>LBL, <span class="at">col =</span> <span class="st">"steelblue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="huong-dan-phan-tich-t-test-trong-r_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>Quantile-Quantile plots for comparing two Distributions</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>lattice<span class="sc">::</span><span class="fu">qq</span>(Species <span class="sc">~</span> LBL, <span class="at">aspect =</span> <span class="dv">1</span>, <span class="at">data =</span> flower,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">subset =</span> (Species <span class="sc">==</span> <span class="st">"Flower A"</span> <span class="sc">|</span> Species <span class="sc">==</span> <span class="st">"Flower B"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="huong-dan-phan-tich-t-test-trong-r_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><span style="color:green"><strong>Cách 2: Shapiro-Wilk Test for Normality (sample size must be between 3 and 5000)</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="at">x =</span> flower_a<span class="sc">$</span>LBL)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  flower_a$LBL
W = 0.91731, p-value = 0.0389</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="at">x =</span> flower_b<span class="sc">$</span>LBL)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  flower_b$LBL
W = 0.94162, p-value = 0.2572</code></pre>
</div>
</div>
<p><strong>Trong Shapiro–Wilk test thì p-value nhỏ hơn 0.05 thì KHÔNG có phân bố chuẩn (do đó vi phạm giả thuyết). p-value lớn hơn 0.05 thì CÓ phân bố chuẩn.</strong></p>
<p><span style="color:green"><strong>Cách 3: Two-sample Kolmogorov-Smirnov’s test for Normality</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(flower_a<span class="sc">$</span>LBL, flower_b<span class="sc">$</span>LBL)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact two-sample Kolmogorov-Smirnov test

data:  flower_a$LBL and flower_b$LBL
D = 0.60769, p-value = 0.0001406
alternative hypothesis: two-sided</code></pre>
</div>
</div>
<p><strong>Biện luận kết quả theo p-value của Kolmogorov-Smirnov’s test.</strong></p>
<p><strong>Tham khảo: <code>https://en.wikipedia.org/wiki/Kolmogorov%E2%80%93Smirnov_test</code></strong></p>
</section>
<section id="bước-3.2-thực-hiện-kiểm-tra-giả-thuyết-về-khác-biệt-phương-sai" class="level5" data-number="9.0.0.3.2">
<h5 data-number="9.0.0.3.2" class="anchored" data-anchor-id="bước-3.2-thực-hiện-kiểm-tra-giả-thuyết-về-khác-biệt-phương-sai"><span class="header-section-number">9.0.0.3.2</span> <span style="color:green"><strong>Bước 3.2: Thực hiện kiểm tra giả thuyết về khác biệt phương sai</strong></span></h5>
<p><strong>We will check whether the variances across the two groups are same or not. Performs an F-test to compare the variances of two samples from normal populations.</strong></p>
<p><code>https://www.datanovia.com/en/lessons/homogeneity-of-variance-test-in-r/</code></p>
<p>There are different variance tests that can be used to assess the equality of variances. These include:</p>
<ul>
<li><p>F-test: Compare the variances of two groups. The data must be normally distributed.</p></li>
<li><p>Bartlett’s test: Compare the variances of two or more groups. The data must be normally distributed.</p></li>
<li><p>Levene’s test: A robust alternative to the Bartlett’s test that is less sensitive to departures from normality.</p></li>
<li><p>Fligner-Killeen’s test: a non-parametric test which is very robust against departures from normality.</p></li>
</ul>
<p><span style="color:green"><strong>Cách 1: Áp dụng F-test</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The statistical hypotheses are:</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Null hypothesis (H0): the variances of the two groups are equal.</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative hypothesis (Ha): the variances are different.</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">var.test</span>(flower_a<span class="sc">$</span>LBL, flower_b<span class="sc">$</span>LBL)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    F test to compare two variances

data:  flower_a$LBL and flower_b$LBL
F = 0.43625, num df = 25, denom df = 19, p-value = 0.05311
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.1787345 1.0114015
sample estimates:
ratio of variances 
         0.4362495 </code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Interpretation. The p-value is p = 0.05311 which is greater than the significance level 0.05. In conclusion, there is no significant difference between the two variances.</p>
</blockquote>
<p><strong>p-value lớn hơn 0.05 nên bác bỏ H1 chấp nhận H0, tức là phương sai của hai nhóm này không khác biệt nhau.</strong></p>
<p><span style="color:green"><strong>Cách 2: Bartlett’s test with one independent variable</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>bar_test <span class="ot">&lt;-</span> <span class="fu">bartlett.test</span>(LBL <span class="sc">~</span> Species, <span class="at">data =</span> flower)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>bar_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  LBL by Species
Bartlett's K-squared = 3.6638, df = 1, p-value = 0.05561</code></pre>
</div>
</div>
<p><strong>p-value lớn hơn 0.05 nên bác bỏ H1 chấp nhận H0, tức là phương sai của hai nhóm này không khác biệt nhau.</strong></p>
<p><span style="color:green"><strong>Cách 3: Áp dụng Levene’s test</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(LBL <span class="sc">~</span> Species, <span class="at">data =</span> flower)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value  Pr(&gt;F)  
group  1  4.3445 0.04297 *
      44                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Trong Levene’s test thì p-value nhỏ hơn 0.05 thì CÓ sự khác biệt về phương sai giữa 2 nhóm. p-value lớn hơn 0.05 thì KHÔNG CÓ sự khác biệt về phương sai giữa 2 nhóm.</p>
<p><span style="color:green"><strong>Cách 4: Áp dụng Fligner-Killeen’s test</strong></span></p>
<p>The Fligner-Killeen’s test is one of the many tests for homogeneity of variances which is most robust against departures from normality.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fligner.test</span>(LBL <span class="sc">~</span> Species, <span class="at">data =</span> flower)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fligner-Killeen test of homogeneity of variances

data:  LBL by Species
Fligner-Killeen:med chi-squared = 4.5799, df = 1, p-value = 0.03235</code></pre>
</div>
</div>
</section>
</section>
<section id="bước-3-thực-hiện-kiểm-định-t-test" class="level4" data-number="9.0.0.4">
<h4 data-number="9.0.0.4" class="anchored" data-anchor-id="bước-3-thực-hiện-kiểm-định-t-test"><span class="header-section-number">9.0.0.4</span> <span style="color:blue"><strong>Bước 3: Thực hiện kiểm định t-test</strong></span></h4>
<blockquote class="blockquote">
<p>Recall that, <strong>by default</strong>, R computes the Welch t-test, which is the safer one. This is the test where you do not assume that the variance is the same in the two groups, which results in the fractional degrees of freedom. If you want to assume the equality of variances (Student t-test), specify the option var.equal = TRUE.</p>
</blockquote>
<p><strong>Trường hợp phương sai không bằng nhau</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>res_1 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(LBL <span class="sc">~</span> Species, <span class="at">data =</span> flower, </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">conf.level =</span> <span class="fl">0.95</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>              <span class="co"># paired = FALSE,</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>res_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  LBL by Species
t = -5.6306, df = 31.22, p-value = 3.44e-06
alternative hypothesis: true difference in means between group Flower A and group Flower B is not equal to 0
95 percent confidence interval:
 -3.420793 -1.601976
sample estimates:
mean in group Flower A mean in group Flower B 
              11.68962               14.20100 </code></pre>
</div>
</div>
<p><strong>Trường hợp phương sai bằng nhau</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>res_2 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(LBL <span class="sc">~</span> Species, <span class="at">data =</span> flower, </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">conf.level =</span> <span class="fl">0.95</span>,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>              <span class="co"># paired = FALSE,</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>res_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  LBL by Species
t = -5.934, df = 44, p-value = 4.219e-07
alternative hypothesis: true difference in means between group Flower A and group Flower B is not equal to 0
95 percent confidence interval:
 -3.364333 -1.658436
sample estimates:
mean in group Flower A mean in group Flower B 
              11.68962               14.20100 </code></pre>
</div>
</div>
<p><strong>Trường hợp nếu không thỏa điều kiện cho phân tích t-test thì ta áp dụng two-samples Wilcoxon test.</strong></p>
<blockquote class="blockquote">
<p>The unpaired two-samples Wilcoxon test (also known as Wilcoxon rank sum test or Mann-Whitney test) is a non-parametric alternative to the unpaired two-samples t-test, which can be used to compare two independent groups of samples. It’s used when your data are not normally distributed.</p>
</blockquote>
</section>
<section id="bước-4-tính-effect-size" class="level4" data-number="9.0.0.5">
<h4 data-number="9.0.0.5" class="anchored" data-anchor-id="bước-4-tính-effect-size"><span class="header-section-number">9.0.0.5</span> <span style="color:blue"><strong>Bước 4: Tính effect size</strong></span></h4>
<p>Salvatore S. Mangiafico. Summary and Analysis of Extension Program Evaluation in R. <code>https://rcompanion.org/documents/RHandbookProgramEvaluation.pdf</code></p>
<blockquote class="blockquote">
<p>Cohen’s d can be used as an effect size statistic for a two-sample t-test. It is calculated as the <em>difference</em> between the means of each group, all divided by the pooled standard deviation of the data.</p>
<p>It ranges from 0 to infinity, with 0 indicating no effect where the means are equal. In some versions, Cohen’s d can be positive or negative depending on which mean is greater.</p>
<p>A Cohen’s d of 0.5 suggests that the means differ by one-half the standard deviation of the data. A Cohen’s d of 1.0 suggests that the means differ by one standard deviation of the data.</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lsr)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>lsr<span class="sc">::</span><span class="fu">cohensD</span>(LBL <span class="sc">~</span> Species, <span class="at">data =</span> flower)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.764908</code></pre>
</div>
</div>
</section>
<section id="bước-5-kiểm-tra-giả-thuyết-cho-t-test-cho-cùng-lúc-nhiều-cột" class="level4" data-number="9.0.0.6">
<h4 data-number="9.0.0.6" class="anchored" data-anchor-id="bước-5-kiểm-tra-giả-thuyết-cho-t-test-cho-cùng-lúc-nhiều-cột"><span class="header-section-number">9.0.0.6</span> <span style="color:blue"><strong>Bước 5: Kiểm tra giả thuyết cho t-test cho cùng lúc nhiều cột</strong></span></h4>
<p>Ta cần chuyển dữ liệu về dạng long để thuận tiện xử lý và vẽ đồ thị.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform the data into long format</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Put all variables in the same column except `Species`, the grouping variable</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> flower</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>mydata.long <span class="ot">&lt;-</span> mydata <span class="sc">%&gt;%</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Species, <span class="at">names_to =</span> <span class="st">"variables"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>mydata.long <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(mydata.long)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>mydata.long</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Species variables  value
1   Flower A       LBL 11.000
2   Flower A       LBW  3.300
3   Flower A      LBAR  3.663
4   Flower A       LBC  0.616
5   Flower A        PL  0.770
6   Flower A       CTL  0.220
7   Flower A       CLL  0.352
8   Flower A       LBL  9.900
9   Flower A       LBW  2.200
10  Flower A      LBAR  4.950
11  Flower A       LBC  0.517
12  Flower A        PL  0.550
13  Flower A       CTL  0.253
14  Flower A       CLL  0.385
15  Flower A       LBL 10.450
16  Flower A       LBW  2.750
17  Flower A      LBAR  4.180
18  Flower A       LBC  0.572
19  Flower A        PL  0.605
20  Flower A       CTL  0.275
21  Flower A       CLL  0.385
22  Flower A       LBL 11.550
23  Flower A       LBW  3.300
24  Flower A      LBAR  3.850
25  Flower A       LBC  0.594
26  Flower A        PL  0.792
27  Flower A       CTL  0.220
28  Flower A       CLL  0.330
29  Flower A       LBL 12.100
30  Flower A       LBW  3.850
31  Flower A      LBAR  3.454
32  Flower A       LBC  0.627
33  Flower A        PL  0.825
34  Flower A       CTL  0.231
35  Flower A       CLL  0.352
36  Flower A       LBL 13.200
37  Flower A       LBW  3.850
38  Flower A      LBAR  3.773
39  Flower A       LBC  0.605
40  Flower A        PL  0.880
41  Flower A       CTL  0.220
42  Flower A       CLL  0.330
43  Flower A       LBL 13.200
44  Flower A       LBW  4.400
45  Flower A      LBAR  3.300
46  Flower A       LBC  0.649
47  Flower A        PL  0.880
48  Flower A       CTL  0.253
49  Flower A       CLL  0.418
50  Flower A       LBL  9.900
51  Flower A       LBW  3.300
52  Flower A      LBAR  3.300
53  Flower A       LBC  0.649
54  Flower A        PL  0.550
55  Flower A       CTL  0.275
56  Flower A       CLL  0.462
57  Flower A       LBL 11.550
58  Flower A       LBW  3.850
59  Flower A      LBAR  3.300
60  Flower A       LBC  0.649
61  Flower A        PL  0.825
62  Flower A       CTL  0.242
63  Flower A       CLL  0.440
64  Flower A       LBL 12.100
65  Flower A       LBW  4.180
66  Flower A      LBAR  3.179
67  Flower A       LBC  0.660
68  Flower A        PL  0.825
69  Flower A       CTL  0.264
70  Flower A       CLL  0.495
71  Flower A       LBL 13.200
72  Flower A       LBW  4.400
73  Flower A      LBAR  3.300
74  Flower A       LBC  0.649
75  Flower A        PL  0.825
76  Flower A       CTL  0.242
77  Flower A       CLL  0.440
78  Flower A       LBL 10.450
79  Flower A       LBW  3.300
80  Flower A      LBAR  3.487
81  Flower A       LBC  0.627
82  Flower A        PL  0.605
83  Flower A       CTL  0.231
84  Flower A       CLL  0.418
85  Flower A       LBL  9.900
86  Flower A       LBW  2.200
87  Flower A      LBAR  4.950
88  Flower A       LBC  0.517
89  Flower A        PL  0.550
90  Flower A       CTL  0.220
91  Flower A       CLL  0.330
92  Flower A       LBL 11.000
93  Flower A       LBW  2.750
94  Flower A      LBAR  4.400
95  Flower A       LBC  0.550
96  Flower A        PL  0.660
97  Flower A       CTL  0.275
98  Flower A       CLL  0.495
99  Flower A       LBL 12.100
100 Flower A       LBW  3.850
101 Flower A      LBAR  3.454
102 Flower A       LBC  0.627
103 Flower A        PL  0.814
104 Flower A       CTL  0.275
105 Flower A       CLL  0.495
106 Flower A       LBL 13.200
107 Flower A       LBW  4.400
108 Flower A      LBAR  3.300
109 Flower A       LBC  0.649
110 Flower A        PL  0.880
111 Flower A       CTL  0.264
112 Flower A       CLL  0.462
113 Flower A       LBL 12.760
114 Flower A       LBW  4.070
115 Flower A      LBAR  3.454
116 Flower A       LBC  0.638
117 Flower A        PL  0.825
118 Flower A       CTL  0.242
119 Flower A       CLL  0.451
120 Flower A       LBL 11.000
121 Flower A       LBW  3.410
122 Flower A      LBAR  3.553
123 Flower A       LBC  0.627
124 Flower A        PL  0.770
125 Flower A       CTL  0.231
126 Flower A       CLL  0.440
127 Flower A       LBL 11.440
128 Flower A       LBW  3.850
129 Flower A      LBAR  3.267
130 Flower A       LBC  0.649
131 Flower A        PL  0.792
132 Flower A       CTL  0.253
133 Flower A       CLL  0.440
134 Flower A       LBL  9.900
135 Flower A       LBW  2.750
136 Flower A      LBAR  3.960
137 Flower A       LBC  0.583
138 Flower A        PL  0.550
139 Flower A       CTL  0.242
140 Flower A       CLL  0.418
141 Flower A       LBL 11.770
142 Flower A       LBW  3.850
143 Flower A      LBAR  3.366
144 Flower A       LBC  0.638
145 Flower A        PL  0.715
146 Flower A       CTL  0.231
147 Flower A       CLL  0.385
148 Flower A       LBL 12.100
149 Flower A       LBW  3.850
150 Flower A      LBAR  3.454
151 Flower A       LBC  0.627
152 Flower A        PL  0.792
153 Flower A       CTL  0.264
154 Flower A       CLL  0.495
155 Flower A       LBL 12.650
156 Flower A       LBW  4.180
157 Flower A      LBAR  3.333
158 Flower A       LBC  0.649
159 Flower A        PL  0.825
160 Flower A       CTL  0.242
161 Flower A       CLL  0.440
162 Flower A       LBL 13.200
163 Flower A       LBW  4.400
164 Flower A      LBAR  3.300
165 Flower A       LBC  0.649
166 Flower A        PL  0.880
167 Flower A       CTL  0.264
168 Flower A       CLL  0.473
169 Flower A       LBL 11.660
170 Flower A       LBW  3.520
171 Flower A      LBAR  3.641
172 Flower A       LBC  0.616
173 Flower A        PL  0.748
174 Flower A       CTL  0.231
175 Flower A       CLL  0.418
176 Flower A       LBL 12.650
177 Flower A       LBW  4.180
178 Flower A      LBAR  3.333
179 Flower A       LBC  0.649
180 Flower A        PL  0.847
181 Flower A       CTL  0.275
182 Flower A       CLL  0.495
183 Flower B       LBL 12.100
184 Flower B       LBW  3.520
185 Flower B      LBAR  3.784
186 Flower B       LBC  0.605
187 Flower B        PL  0.660
188 Flower B       CTL  0.110
189 Flower B       CLL  0.880
190 Flower B       LBL 11.000
191 Flower B       LBW  3.300
192 Flower B      LBAR  3.663
193 Flower B       LBC  0.616
194 Flower B        PL  0.550
195 Flower B       CTL  0.165
196 Flower B       CLL  0.990
197 Flower B       LBL 11.550
198 Flower B       LBW  3.300
199 Flower B      LBAR  3.850
200 Flower B       LBC  0.594
201 Flower B        PL  0.550
202 Flower B       CTL  0.220
203 Flower B       CLL  1.210
204 Flower B       LBL 13.200
205 Flower B       LBW  3.410
206 Flower B      LBAR  4.257
207 Flower B       LBC  0.561
208 Flower B        PL  0.770
209 Flower B       CTL  0.220
210 Flower B       CLL  1.320
211 Flower B       LBL 13.200
212 Flower B       LBW  3.410
213 Flower B      LBAR  4.257
214 Flower B       LBC  0.561
215 Flower B        PL  0.715
216 Flower B       CTL  0.132
217 Flower B       CLL  0.990
218 Flower B       LBL 15.400
219 Flower B       LBW  3.740
220 Flower B      LBAR  4.532
221 Flower B       LBC  0.539
222 Flower B        PL  0.770
223 Flower B       CTL  0.165
224 Flower B       CLL  0.990
225 Flower B       LBL 15.400
226 Flower B       LBW  3.520
227 Flower B      LBAR  4.818
228 Flower B       LBC  0.528
229 Flower B        PL  0.770
230 Flower B       CTL  0.198
231 Flower B       CLL  1.100
232 Flower B       LBL 16.500
233 Flower B       LBW  3.850
234 Flower B      LBAR  4.719
235 Flower B       LBC  0.528
236 Flower B        PL  0.825
237 Flower B       CTL  0.176
238 Flower B       CLL  1.034
239 Flower B       LBL 16.500
240 Flower B       LBW  3.740
241 Flower B      LBAR  4.851
242 Flower B       LBC  0.517
243 Flower B        PL  0.880
244 Flower B       CTL  0.209
245 Flower B       CLL  1.320
246 Flower B       LBL 16.500
247 Flower B       LBW  3.740
248 Flower B      LBAR  4.851
249 Flower B       LBC  0.517
250 Flower B        PL  0.880
251 Flower B       CTL  0.110
252 Flower B       CLL  0.880
253 Flower B       LBL 14.300
254 Flower B       LBW  3.520
255 Flower B      LBAR  4.466
256 Flower B       LBC  0.550
257 Flower B        PL  0.660
258 Flower B       CTL  0.132
259 Flower B       CLL  0.935
260 Flower B       LBL 14.300
261 Flower B       LBW  3.520
262 Flower B      LBAR  4.466
263 Flower B       LBC  0.550
264 Flower B        PL  0.660
265 Flower B       CTL  0.198
266 Flower B       CLL  1.100
267 Flower B       LBL 13.750
268 Flower B       LBW  3.410
269 Flower B      LBAR  4.433
270 Flower B       LBC  0.550
271 Flower B        PL  0.616
272 Flower B       CTL  0.176
273 Flower B       CLL  1.045
274 Flower B       LBL 13.200
275 Flower B       LBW  3.520
276 Flower B      LBAR  4.125
277 Flower B       LBC  0.572
278 Flower B        PL  0.660
279 Flower B       CTL  0.165
280 Flower B       CLL  0.990
281 Flower B       LBL 12.650
282 Flower B       LBW  3.300
283 Flower B      LBAR  4.213
284 Flower B       LBC  0.572
285 Flower B        PL  0.605
286 Flower B       CTL  0.209
287 Flower B       CLL  1.320
288 Flower B       LBL 12.870
289 Flower B       LBW  3.520
290 Flower B      LBAR  4.026
291 Flower B       LBC  0.583
292 Flower B        PL  0.605
293 Flower B       CTL  0.220
294 Flower B       CLL  1.320
295 Flower B       LBL 14.300
296 Flower B       LBW  3.300
297 Flower B      LBAR  4.763
298 Flower B       LBC  0.528
299 Flower B        PL  0.660
300 Flower B       CTL  0.220
301 Flower B       CLL  1.320
302 Flower B       LBL 14.850
303 Flower B       LBW  3.740
304 Flower B      LBAR  4.367
305 Flower B       LBC  0.550
306 Flower B        PL  0.660
307 Flower B       CTL  0.220
308 Flower B       CLL  1.210
309 Flower B       LBL 15.950
310 Flower B       LBW  3.850
311 Flower B      LBAR  4.554
312 Flower B       LBC  0.539
313 Flower B        PL  0.792
314 Flower B       CTL  0.187
315 Flower B       CLL  1.100
316 Flower B       LBL 16.500
317 Flower B       LBW  3.850
318 Flower B      LBAR  4.719
319 Flower B       LBC  0.528
320 Flower B        PL  0.880
321 Flower B       CTL  0.176
322 Flower B       CLL  0.990</code></pre>
</div>
</div>
<p><strong>Run multiple t-tests</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>stat.test <span class="ot">&lt;-</span> mydata.long <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(variables) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t_test</span>(value <span class="sc">~</span> Species) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_pvalue</span>(<span class="at">method =</span> <span class="st">"BH"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_significance</span>()</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>stat.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(stat.test)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>stat.test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  variables   .y.   group1   group2 n1 n2  statistic       df        p        p.adj p.adj.signif
1       CLL value Flower A Flower B 26 20 -18.651023 22.60898 3.19e-15 2.233000e-14         ****
2       CTL value Flower A Flower B 26 20   7.421902 27.19379 5.29e-08 1.851500e-07         ****
3      LBAR value Flower A Flower B 26 20  -5.999057 43.95851 3.40e-07 5.950000e-07         ****
4       LBC value Flower A Flower B 26 20   6.299147 43.76586 1.25e-07 2.916667e-07         ****
5       LBL value Flower A Flower B 26 20  -5.630632 31.21960 3.44e-06 4.816000e-06         ****
6       LBW value Flower A Flower B 26 20   0.442909 30.60858 6.61e-01 6.610000e-01           ns
7        PL value Flower A Flower B 26 20   1.362387 42.49847 1.80e-01 2.100000e-01           ns</code></pre>
</div>
</div>
<p><strong>Create individual boxplots with t-test p-values</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># multi-panel</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # Create the plot</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># myplot &lt;- ggboxplot(</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   mydata.long, x = "Species", y = "value",</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   fill = "Species", palette = "npg", legend = "none",</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggtheme = theme_pubr(border = TRUE)</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) +</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_wrap(~variables)</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # Add statistical test p-values</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co"># stat.test &lt;- stat.test %&gt;% add_xy_position(x = "Species")</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co"># myplot + stat_pvalue_manual(stat.test, label = "p.adj.signif")</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Group the data by variables and do a graph for each variable</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>stat.test <span class="ot">&lt;-</span> stat.test <span class="sc">%&gt;%</span> <span class="fu">add_xy_position</span>(<span class="at">x =</span> <span class="st">"Species"</span>)</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>graphs <span class="ot">&lt;-</span> mydata.long <span class="sc">%&gt;%</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(variables) <span class="sc">%&gt;%</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">doo</span>(</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span><span class="fu">ggboxplot</span>(</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span>., <span class="at">x =</span> <span class="st">"Species"</span>, <span class="at">y =</span> <span class="st">"value"</span>,</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"Species"</span>, <span class="at">palette =</span> <span class="st">"npg"</span>, <span class="at">legend =</span> <span class="st">"none"</span>,</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">ggtheme =</span> <span class="fu">theme_pubr</span>()</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">result =</span> <span class="st">"plots"</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a><span class="co"># graphs</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Add statitistical tests to each corresponding plot</span></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> graphs<span class="sc">$</span>variables</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(variables)){</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>  graph.i <span class="ot">&lt;-</span> graphs<span class="sc">$</span>plots[[i]] <span class="sc">+</span> </span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> variables[i]) <span class="sc">+</span> </span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_pvalue_manual</span>(stat.test[i, ], <span class="at">label =</span> <span class="st">"p.adj.signif"</span>)</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(graph.i)</span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="huong-dan-phan-tich-t-test-trong-r_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="huong-dan-phan-tich-t-test-trong-r_files/figure-html/unnamed-chunk-19-2.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="huong-dan-phan-tich-t-test-trong-r_files/figure-html/unnamed-chunk-19-3.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="huong-dan-phan-tich-t-test-trong-r_files/figure-html/unnamed-chunk-19-4.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="huong-dan-phan-tich-t-test-trong-r_files/figure-html/unnamed-chunk-19-5.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="huong-dan-phan-tich-t-test-trong-r_files/figure-html/unnamed-chunk-19-6.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="huong-dan-phan-tich-t-test-trong-r_files/figure-html/unnamed-chunk-19-7.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="tài-liệu-tham-khảo" class="level4" data-number="9.0.0.7">
<h4 data-number="9.0.0.7" class="anchored" data-anchor-id="tài-liệu-tham-khảo"><span class="header-section-number">9.0.0.7</span> Tài liệu tham khảo</h4>
<ol type="1">
<li><p><code>https://www.sthda.com/english/wiki/unpaired-two-samples-t-test-in-r</code></p></li>
<li><p><code>https://www.datanovia.com/en/lessons/how-to-do-a-t-test-in-r-calculation-and-reporting/</code></p></li>
<li><p><code>https://www.datanovia.com/en/blog/how-to-perform-multiple-t-test-in-r-for-different-variables/</code></p></li>
<li><p><code>https://rpubs.com/SameerMathur/t-testAssumptions</code></p></li>
<li><p><code>https://cran.r-project.org/web/packages/qqplotr/vignettes/introduction.html</code></p></li>
<li><p><code>https://astrostatistics.psu.edu/su07/R/html/lattice/html/qq.html</code></p></li>
<li><p><code>https://adiradaniel.netlify.app/post/ggmultipane/</code></p></li>
<li><p><a href="https://rcompanion.org/handbook/I_03.html">Tính diff mean trong t-test two samples</a></p></li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-page-right">
  <div class="nav-page nav-page-previous">
      <a href="./khoang-tin-cay.html" class="pagination-link" aria-label="<b>Khoảng tin cậy là gì?</b>">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title"><b>Khoảng tin cậy là gì?</b></span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./phan-tich-anova-2-yeu-to-trong-r.html" class="pagination-link" aria-label="<b>Phân tích ANOVA 2 yếu tố trong R</b>">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title"><b>Phân tích ANOVA 2 yếu tố trong R</b></span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>