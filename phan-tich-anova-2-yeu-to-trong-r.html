<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Thống kê sinh học: Từ lý thuyết đến ứng dụng - 8&nbsp; Phân tích ANOVA 2 yếu tố trong R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./so-sanh-ket-qua-giua-parametric-va-non-parametric-anova.html" rel="next">
<link href="./huong-dan-phan-tich-t-test-trong-r.html" rel="prev">
<link href="./favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./co-so-ly-thuyet.html">Cơ sở lý thuyết</a></li><li class="breadcrumb-item"><a href="./phan-tich-anova-2-yeu-to-trong-r.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title"><b>Phân tích ANOVA 2 yếu tố trong R</b></span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./"></a><a href="https://thongkesinhhoc.com/">Thống kê sinh học: Từ lý thuyết đến ứng dụng</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Giới thiệu</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./cac-lenh-do-thi-can-ban-su-dung-base-r-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Các lệnh đồ thị căn bản sử dụng Base R Graphics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./huong-dan-ve-do-thi-cot-base-r-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title"><b>Hướng dẫn vẽ đồ thị cột bằng Base R Graphics</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./huong-dan-cach-thay-doi-do-rong-cot-trong-barplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title"><b>Hướng dẫn cách thay đổi độ rộng cột trong barplot</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tinh-huong-base-r-graphics-thuong-gap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title"><b>Tình huống Base R Graphics thường gặp</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./huong-dan-ve-do-thi-nhieu-truc-y.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title"><b>Hướng dẫn vẽ đồ thị nhiều trục Y</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./huong-dan-ve-do-thi-bang-package-lattice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title"><b>Hướng dẫn vẽ đồ thị bằng package <code>lattice</code></b></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./co-so-ly-thuyet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cơ sở lý thuyết</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./khoang-tin-cay.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title"><b>Khoảng tin cậy là gì?</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./huong-dan-phan-tich-t-test-trong-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title"><b>Hướng dẫn phân tích t-test trong R</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./phan-tich-anova-2-yeu-to-trong-r.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title"><b>Phân tích ANOVA 2 yếu tố trong R</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./so-sanh-ket-qua-giua-parametric-va-non-parametric-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title"><b>So sánh kết quả giữa phân tích parametric và non-parametric ANOVA</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./phan-tich-ancova-trong-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title"><b>Phân tích ANCOVA trong R</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quy-trinh-phan-tich-logistic-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title"><b>Quy trình phân tích logistic regression</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./khai-niem-bootstrap-qua-vi-du-tinh-trung-binh-mau.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title"><b>Khái niệm về bootstrap qua ví dụ tính trung bình mẫu</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bo-tri-thi-nghiem-toi-uu-hoa-bang-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title"><b>Bố trí thí nghiệm tối ưu hóa bằng R</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow-phan-tich-thong-ke-qua-dataset-iris.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title"><b>Workflow phân tích thống kê qua dataset <code>iris</code> </b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-partial-least-squares-and-principal-component-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title"><b>Example for Partial Least Squares and Principal Component Regression</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tai-lieu-phan-tich-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title"><b>Tài liệu phân tích PCA</b></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Kỹ thuật xử lý dữ liệu</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./huong-dan-convert-tu-csv-qua-tsv-trong-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title"><b>Hướng dẫn convert từ file <code>csv</code> qua <code>tsv</code> trong R</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./huong-dan-cach-lam-tron-so-trong-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title"><b>Hướng dẫn cách làm tròn số trong R</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./huong-dan-show-all-data-tren-console.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title"><b>Hướng dẫn show all data trên console</b></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ky-thuat-reshape-du-lieu.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title"><b>Kỹ thuật reshape dữ liệu</b></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tài liệu tham khảo</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./co-so-ly-thuyet.html">Cơ sở lý thuyết</a></li><li class="breadcrumb-item"><a href="./phan-tich-anova-2-yeu-to-trong-r.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title"><b>Phân tích ANOVA 2 yếu tố trong R</b></span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title"><b>Phân tích ANOVA 2 yếu tố trong R</b></span></h1>
</div>



<div class="quarto-title-meta column-page-right">

    
  
    
  </div>
  


</header>


<p><strong>Câu hỏi nghiên cứu: Xác định tổ hợp giữa cơ chất và vi sinh vật để thu được hoạt tính enzyme cao</strong></p>
<section id="bước-1-import-dữ-liệu" class="level3" data-number="8.0.1">
<h3 data-number="8.0.1" class="anchored" data-anchor-id="bước-1-import-dữ-liệu"><span class="header-section-number">8.0.1</span> <span style="color:blue">Bước 1: Import dữ liệu</span></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>enzyme_df <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"activity.xlsx"</span>, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>enzyme_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(enzyme_df)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>enzyme_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     substrate bacillus  enzyme
1  substrate_a     AB12 26.4125
2  substrate_a     AB12 32.4125
3  substrate_a     AB12 27.3000
4  substrate_b     AB12 12.7500
5  substrate_b     AB12 11.9625
6  substrate_b     AB12  8.9500
7  substrate_c     AB12 23.2000
8  substrate_c     AB12 25.8625
9  substrate_c     AB12 24.2750
10 substrate_d     AB12 48.1375
11 substrate_d     AB12 45.9125
12 substrate_d     AB12 47.7750
13 substrate_e     AB12 43.7250
14 substrate_e     AB12 44.6000
15 substrate_e     AB12 42.3875
16 substrate_a     CD47 32.2750
17 substrate_a     CD47 30.2250
18 substrate_a     CD47 32.5125
19 substrate_b     CD47 10.4750
20 substrate_b     CD47  9.9250
21 substrate_b     CD47 10.0375
22 substrate_c     CD47 15.4625
23 substrate_c     CD47 19.7250
24 substrate_c     CD47 17.9125
25 substrate_d     CD47 24.0625
26 substrate_d     CD47 25.4750
27 substrate_d     CD47 24.8375
28 substrate_e     CD47 22.6500
29 substrate_e     CD47 22.1625
30 substrate_e     CD47 21.5500
31 substrate_a     ER12 40.2375
32 substrate_a     ER12 36.1750
33 substrate_a     ER12 39.2125
34 substrate_b     ER12 14.7250
35 substrate_b     ER12 15.1750
36 substrate_b     ER12 16.0625
37 substrate_c     ER12 20.1875
38 substrate_c     ER12 21.5125
39 substrate_c     ER12 21.7250
40 substrate_d     ER12 53.1875
41 substrate_d     ER12 53.1000
42 substrate_d     ER12 52.5750
43 substrate_e     ER12 45.6625
44 substrate_e     ER12 45.3625
45 substrate_e     ER12 44.7000
46 substrate_a     MS16 36.1500
47 substrate_a     MS16 35.0625
48 substrate_a     MS16 33.5375
49 substrate_b     MS16 16.5250
50 substrate_b     MS16 21.4375
51 substrate_b     MS16 18.6750
52 substrate_c     MS16 25.1875
53 substrate_c     MS16 25.5375
54 substrate_c     MS16 26.6250
55 substrate_d     MS16 43.2500
56 substrate_d     MS16 43.6000
57 substrate_d     MS16 40.4625
58 substrate_e     MS16 52.4125
59 substrate_e     MS16 52.9375
60 substrate_e     MS16 53.0125</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(enzyme_df<span class="sc">$</span>substrate, enzyme_df<span class="sc">$</span>bacillus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             
              AB12 CD47 ER12 MS16
  substrate_a    3    3    3    3
  substrate_b    3    3    3    3
  substrate_c    3    3    3    3
  substrate_d    3    3    3    3
  substrate_e    3    3    3    3</code></pre>
</div>
</div>
<p><strong>Chuyển dạng factor cho các biến <code>substrate</code> và <code>bacillus</code>.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>enzyme_df<span class="sc">$</span>substrate <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(enzyme_df<span class="sc">$</span>substrate)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>enzyme_df<span class="sc">$</span>bacillus <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(enzyme_df<span class="sc">$</span>bacillus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="bước-2-giả-thuyết-cho-anova-2-yếu-tố" class="level3" data-number="8.0.2">
<h3 data-number="8.0.2" class="anchored" data-anchor-id="bước-2-giả-thuyết-cho-anova-2-yếu-tố"><span class="header-section-number">8.0.2</span> <span style="color:blue">Bước 2: Giả thuyết cho ANOVA 2 yếu tố</span></h3>
<p>Nguồn: <a href="https://statistics.laerd.com/spss-tutorials/two-way-anova-using-spss-statistics.php" class="uri">https://statistics.laerd.com/spss-tutorials/two-way-anova-using-spss-statistics.php</a></p>
<ul>
<li><p>Assumption #1: Your dependent variable should be measured at the continuous level <span class="math inline">\(\Rightarrow\)</span> <mark style="background-color: #FFFF00">OK</mark></p></li>
<li><p>Assumption #2: Your two independent variables should each consist of two or more categorical, independent groups <span class="math inline">\(\Rightarrow\)</span> <mark style="background-color: #FFFF00">OK</mark></p></li>
<li><p>Assumption #3: You should have independence of observations, which means that there is no relationship between the observations in each group or between the groups themselves. <span class="math inline">\(\Rightarrow\)</span> <mark style="background-color: #FFFF00">OK</mark></p></li>
<li><p>Assumption #4: There should be no significant outliers.</p></li>
<li><p>Assumption #5: Your dependent variable should be approximately normally distributed for each combination of the groups of the two independent variables.</p></li>
<li><p>Assumption #6: There needs to be homogeneity of variances for each combination of the groups of the two independent variables. Again, whilst this sounds a little tricky, you can easily test this assumption in SPSS Statistics using Levene’s test for homogeneity of variances.</p></li>
</ul>
</section>
<section id="bước-3-kiểm-tra-giả-thuyết-cho-anova" class="level3" data-number="8.0.3">
<h3 data-number="8.0.3" class="anchored" data-anchor-id="bước-3-kiểm-tra-giả-thuyết-cho-anova"><span class="header-section-number">8.0.3</span> <span style="color:blue">Bước 3: Kiểm tra giả thuyết cho ANOVA</span></h3>
<section id="bước-3.1-kiểm-tra-giả-thuyết-assumption-5-normally-distributed-for-each-combination-of-the-groups" class="level4" data-number="8.0.3.1">
<h4 data-number="8.0.3.1" class="anchored" data-anchor-id="bước-3.1-kiểm-tra-giả-thuyết-assumption-5-normally-distributed-for-each-combination-of-the-groups"><span class="header-section-number">8.0.3.1</span> <strong><span style="color:red">Bước 3.1: Kiểm tra giả thuyết Assumption #5 normally distributed for each combination of the groups</span></strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute two-way ANOVA test with interaction effect</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>res.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(enzyme <span class="sc">~</span> substrate <span class="sc">*</span> bacillus, <span class="at">data =</span> enzyme_df)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>aov_residuals <span class="ot">&lt;-</span> <span class="fu">residuals</span>(<span class="at">object =</span> res.aov)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="at">x =</span> aov_residuals) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  aov_residuals
W = 0.96772, p-value = 0.1127</code></pre>
</div>
</div>
<p>Kết quả Shapiro-Wilk normality test cho thấy p-value là 0.1127 lớn hơn 0.05. Do đó bộ dataset này có sự phân bố chuẩn <span class="math inline">\(\Rightarrow\)</span> <mark style="background-color: #FFFF00">OK</mark></p>
<p><a href="https://en.wikipedia.org/wiki/Shapiro%E2%80%93Wilk_test" class="uri">https://en.wikipedia.org/wiki/Shapiro%E2%80%93Wilk_test</a></p>
<blockquote class="blockquote">
<p>The Shapiro–Wilk test is a test of normality. The null-hypothesis of this test is that the population is normally distributed. Thus, if the p value is less than the chosen alpha level, then the null hypothesis is rejected and there is evidence that the data tested are not normally distributed. On the other hand, if the p value is greater than the chosen alpha level, then the null hypothesis (that the data came from a normally distributed population) can not be rejected (e.g., for an alpha level of .05, a data set with a p value of less than .05 rejects the null hypothesis that the data are from a normally distributed population – consequently, a data set with a p value more than the .05 alpha value fails to reject the null hypothesis that the data is from a normally distributed population).</p>
</blockquote>
<p><strong><mark style="background-color: #FFFF00">Tóm lại trong Shapiro–Wilk test thì p-value nhỏ hơn 0.05 thì KHÔNG có phân bố chuẩn (do đó vi phạm giả thuyết). p-value lớn hơn 0.05 thì CÓ phân bố chuẩn.</mark></strong></p>
</section>
<section id="bước-3.2-kiểm-tra-giả-thuyết-assumption-6-homogeneity-of-variances" class="level4" data-number="8.0.3.2">
<h4 data-number="8.0.3.2" class="anchored" data-anchor-id="bước-3.2-kiểm-tra-giả-thuyết-assumption-6-homogeneity-of-variances"><span class="header-section-number">8.0.3.2</span> <strong><span style="color:red">Bước 3.2: Kiểm tra giả thuyết Assumption #6 homogeneity of variances</span></strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(enzyme <span class="sc">~</span> substrate <span class="sc">*</span> bacillus, <span class="at">data =</span> enzyme_df) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group 19  0.6694 0.8254
      40               </code></pre>
</div>
</div>
<p>Kết quả Levene’s test cho thấy p-value là 0.8254 lớn hơn 0.05. Do đó bộ dataset này có không có sự khác biệt về phương sai giữa các tổ hợp các mức khác nhau của 2 biến <span class="math inline">\(\Rightarrow\)</span> <mark style="background-color: #FFFF00">OK</mark></p>
<p><a href="https://en.wikipedia.org/wiki/Levene%27s_test" class="uri">https://en.wikipedia.org/wiki/Levene%27s_test</a></p>
<blockquote class="blockquote">
<p>In statistics, Levene’s test is an inferential statistic used to assess the equality of variances for a variable calculated for two or more groups. Some common statistical procedures assume that variances of the populations from which different samples are drawn are equal. Levene’s test assesses this assumption. It tests the null hypothesis that the population variances are equal (called homogeneity of variance or homoscedasticity). If the resulting p-value of Levene’s test is less than some significance level (typically 0.05), the obtained differences in sample variances are unlikely to have occurred based on random sampling from a population with equal variances. Thus, the null hypothesis of equal variances is rejected and it is concluded that there is a difference between the variances in the population.</p>
</blockquote>
<p><strong><mark style="background-color: #FFFF00">Tóm lại trong Levene’s test thì p-value nhỏ hơn 0.05 thì CÓ sự khác biệt về phương sai giữa các tổ hợp yếu tố (do đó vi phạm giả thuyết). p-value lớn hơn 0.05 thì KHÔNG CÓ sự khác biệt về phương sai giữa các tổ hợp các mức của 2 yếu tố.</mark></strong></p>
</section>
<section id="bước-3.3-kiểm-tra-giả-thuyết-assumption-4-kiểm-tra-outlier" class="level4" data-number="8.0.3.3">
<h4 data-number="8.0.3.3" class="anchored" data-anchor-id="bước-3.3-kiểm-tra-giả-thuyết-assumption-4-kiểm-tra-outlier"><span class="header-section-number">8.0.3.3</span> <strong><span style="color:red">Bước 3.3: Kiểm tra giả thuyết Assumption #4 kiểm tra outlier</span></strong></h4>
<p>Có nhiều phương pháp để detect outliers trong dataset.</p>
<p><strong>Cách 1: Multivariate Model Approach - Cook’s Distance</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(enzyme <span class="sc">~</span> substrate <span class="sc">*</span> bacillus, <span class="at">data =</span> enzyme_df)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>cooksd <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(mod)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cooksd, <span class="at">pch =</span> <span class="st">"*"</span>, </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">"Influential Obs by Cooks distance"</span>)  <span class="co"># plot cook's distance</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">4</span><span class="sc">*</span><span class="fu">mean</span>(cooksd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">col=</span><span class="st">"red"</span>)  <span class="co"># add cutoff line</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cooksd) <span class="sc">+</span> <span class="dv">1</span>, <span class="at">y =</span> cooksd, </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">ifelse</span>(cooksd <span class="sc">&gt;</span> <span class="dv">4</span><span class="sc">*</span><span class="fu">mean</span>(cooksd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">names</span>(cooksd), <span class="st">""</span>), <span class="at">col =</span> <span class="st">"red"</span>)  <span class="co"># add labels</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="phan-tich-anova-2-yeu-to-trong-r_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>influential <span class="ot">&lt;-</span> cooksd <span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">*</span> <span class="fu">mean</span>(cooksd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>enzyme_df[influential, ] <span class="do">## giá trị outlier</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     substrate bacillus  enzyme
2  substrate_a     AB12 32.4125
50 substrate_b     MS16 21.4375</code></pre>
</div>
</div>
<p><strong>Cách 2: Dùng function <code>car::outlierTest</code></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">outlierTest</span>(mod) <span class="ot">-&gt;</span> ok</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># names(ok$p)</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>enzyme_df[<span class="fu">names</span>(ok<span class="sc">$</span>p), ] <span class="do">## giá trị outlier</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    substrate bacillus  enzyme
2 substrate_a     AB12 32.4125</code></pre>
</div>
</div>
<p><strong>Cách 3: Dùng package <code>outliers</code></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">### sử dụng function outlier() cho vector enzyme activity</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(outliers)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>outliers<span class="sc">::</span><span class="fu">outlier</span>(enzyme_df<span class="sc">$</span>enzyme, <span class="at">opposite =</span> <span class="cn">TRUE</span>) <span class="ot">-&gt;</span> yes_1</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>enzyme_df <span class="sc">|&gt;</span> <span class="fu">subset</span>(enzyme <span class="sc">==</span> yes_1) <span class="co"># vị trí outlier</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    substrate bacillus enzyme
6 substrate_b     AB12   8.95</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">### sử dụng function scores() cho vector enzyme activity</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># outliers::scores(enzyme_df$enzyme, type = "chisq", prob = 0.95) </span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># outliers::scores(enzyme_df$enzyme, type = "t", prob = 0.95) </span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>outliers<span class="sc">::</span><span class="fu">scores</span>(enzyme_df<span class="sc">$</span>enzyme, <span class="at">type =</span> <span class="st">"z"</span>, <span class="at">prob =</span> <span class="fl">0.95</span>) <span class="ot">-&gt;</span> yes_2</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>enzyme_df[yes_2, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     substrate bacillus  enzyme
40 substrate_d     ER12 53.1875
41 substrate_d     ER12 53.1000
42 substrate_d     ER12 52.5750
58 substrate_e     MS16 52.4125
59 substrate_e     MS16 52.9375
60 substrate_e     MS16 53.0125</code></pre>
</div>
</div>
<p><strong>Cách 4: Dùng đồ thị Q-Q plot</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(enzyme <span class="sc">~</span> substrate <span class="sc">*</span> bacillus, <span class="at">data =</span> enzyme_df)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="phan-tich-anova-2-yeu-to-trong-r_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="phan-tich-anova-2-yeu-to-trong-r_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="phan-tich-anova-2-yeu-to-trong-r_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="phan-tich-anova-2-yeu-to-trong-r_files/figure-html/unnamed-chunk-9-4.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="phan-tich-anova-2-yeu-to-trong-r_files/figure-html/unnamed-chunk-9-5.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod, <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="phan-tich-anova-2-yeu-to-trong-r_files/figure-html/unnamed-chunk-9-6.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sort(abs(residuals(mod)), decreasing = TRUE) # save the residuals</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>enzyme_df[<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">32</span>, <span class="dv">50</span>), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     substrate bacillus  enzyme
2  substrate_a     AB12 32.4125
32 substrate_a     ER12 36.1750
50 substrate_b     MS16 21.4375</code></pre>
</div>
</div>
<p><strong>Cách 5: Dùng function <code>car::influencePlot</code></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>outs <span class="ot">&lt;-</span> car<span class="sc">::</span><span class="fu">influencePlot</span>(mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="phan-tich-anova-2-yeu-to-trong-r_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>enzyme_df[<span class="fu">row.names</span>(outs), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     substrate bacillus  enzyme
2  substrate_a     AB12 32.4125
3  substrate_a     AB12 27.3000
4  substrate_b     AB12 12.7500
50 substrate_b     MS16 21.4375</code></pre>
</div>
</div>
</section>
</section>
<section id="bước-4-kiểm-tra-đặc-điểm-dữ-liệu" class="level3" data-number="8.0.4">
<h3 data-number="8.0.4" class="anchored" data-anchor-id="bước-4-kiểm-tra-đặc-điểm-dữ-liệu"><span class="header-section-number">8.0.4</span> <span style="color:blue">Bước 4: Kiểm tra đặc điểm dữ liệu</span></h3>
<p><strong>Histogram theo các mức trong <code>substrate</code></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>( <span class="sc">~</span> enzyme <span class="sc">|</span> substrate, <span class="at">data =</span> enzyme_df,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab =</span> <span class="st">"Enzyme activity (FU/mL)"</span>, <span class="at">type =</span> <span class="st">"density"</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel =</span> <span class="cf">function</span>(x, ...) {</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">panel.histogram</span>(x, ...)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>             <span class="fu">panel.mathdensity</span>(<span class="at">dmath =</span> dnorm, <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean=</span><span class="fu">mean</span>(x),<span class="at">sd=</span><span class="fu">sd</span>(x)))</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>           } )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="phan-tich-anova-2-yeu-to-trong-r_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>Histogram theo các mức trong <code>bacillus</code></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>( <span class="sc">~</span> enzyme <span class="sc">|</span> bacillus, <span class="at">data =</span> enzyme_df,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab =</span> <span class="st">"Enzyme activity (FU/mL)"</span>, <span class="at">type =</span> <span class="st">"density"</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel =</span> <span class="cf">function</span>(x, ...) {</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">panel.histogram</span>(x, ...)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>             <span class="fu">panel.mathdensity</span>(<span class="at">dmath =</span> dnorm, <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean=</span><span class="fu">mean</span>(x),<span class="at">sd=</span><span class="fu">sd</span>(x)))</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>           } )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="phan-tich-anova-2-yeu-to-trong-r_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>Boxplot với tổ hợp các nghiệm thức</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggboxplot</span>(enzyme_df, <span class="at">x =</span> <span class="st">"bacillus"</span>, <span class="at">y =</span> <span class="st">"enzyme"</span>, <span class="at">color =</span> <span class="st">"substrate"</span>, <span class="at">ylab =</span> <span class="st">"Enzyme activity (FU/mL)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="phan-tich-anova-2-yeu-to-trong-r_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>Lineplot với tổ hợp các nghiệm thức</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ggpubr"</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggline</span>(enzyme_df, <span class="at">x =</span> <span class="st">"bacillus"</span>, <span class="at">y =</span> <span class="st">"enzyme"</span>, <span class="at">color =</span> <span class="st">"substrate"</span>, <span class="at">ylab =</span> <span class="st">"Enzyme activity (FU/mL)"</span>,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">add =</span> <span class="fu">c</span>(<span class="st">"mean_sd"</span>, <span class="st">"dotplot"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="phan-tich-anova-2-yeu-to-trong-r_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>Box plot with two factor variables</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>enzyme_df<span class="sc">$</span>substrate <span class="ot">&lt;-</span> <span class="fu">reorder</span>(enzyme_df<span class="sc">$</span>substrate, enzyme_df<span class="sc">$</span>enzyme, <span class="at">decreasing =</span> <span class="cn">FALSE</span>) </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>enzyme_df<span class="sc">$</span>bacillus <span class="ot">&lt;-</span> <span class="fu">reorder</span>(enzyme_df<span class="sc">$</span>bacillus, enzyme_df<span class="sc">$</span>enzyme, <span class="at">decreasing =</span> <span class="cn">FALSE</span>) </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">12</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(enzyme <span class="sc">~</span> substrate <span class="sc">*</span> bacillus, <span class="at">data =</span> enzyme_df, <span class="at">frame =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">horizontal =</span> <span class="cn">TRUE</span>, <span class="at">las =</span> <span class="dv">1</span>,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axisnames =</span> <span class="cn">TRUE</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">xlab =</span> <span class="st">"Enzyme activity (FU/mL)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="phan-tich-anova-2-yeu-to-trong-r_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>Two-way interaction plot</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction.plot</span>(<span class="at">x.factor =</span> enzyme_df<span class="sc">$</span>bacillus, <span class="at">trace.factor =</span> enzyme_df<span class="sc">$</span>substrate, </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">trace.label =</span> <span class="st">"Substrate"</span>,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">response =</span> enzyme_df<span class="sc">$</span>enzyme, <span class="at">fun =</span> mean, </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">legend =</span> <span class="cn">TRUE</span>, </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(Bacillus) <span class="sc">~</span> <span class="st">".sp"</span>), <span class="at">ylab =</span><span class="st">"Enzyme activity (FU/mL)"</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">8</span>, <span class="dv">17</span>, <span class="dv">19</span>), </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"darkgreen"</span>, <span class="st">"purple"</span>, <span class="st">"yellow4"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="phan-tich-anova-2-yeu-to-trong-r_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction.plot</span>(<span class="at">x.factor =</span> enzyme_df<span class="sc">$</span>substrate, <span class="at">trace.factor =</span> enzyme_df<span class="sc">$</span>bacillus, </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">trace.label =</span> <span class="st">"Bacillus .sp"</span>,</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">response =</span> enzyme_df<span class="sc">$</span>enzyme, <span class="at">fun =</span> mean, </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">legend =</span> <span class="cn">TRUE</span>, </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">xlab =</span> <span class="st">"Substrate"</span>, <span class="at">ylab =</span><span class="st">"Enzyme activity (FU/mL)"</span>,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">8</span>, <span class="dv">17</span>, <span class="dv">19</span>), </span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"darkgreen"</span>, <span class="st">"purple"</span>, <span class="st">"yellow4"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="phan-tich-anova-2-yeu-to-trong-r_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="bước-5-phân-tích-anova-2-yếu-tố-crd" class="level3" data-number="8.0.5">
<h3 data-number="8.0.5" class="anchored" data-anchor-id="bước-5-phân-tích-anova-2-yếu-tố-crd"><span class="header-section-number">8.0.5</span> <span style="color:blue">Bước 5: Phân tích ANOVA 2 yếu tố CRD</span></h3>
<p><strong>Tính p-value</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute two-way ANOVA test</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>res.aov2 <span class="ot">&lt;-</span> <span class="fu">aov</span>(enzyme <span class="sc">~</span> substrate <span class="sc">+</span> bacillus, <span class="at">data =</span> enzyme_df)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(res.aov2)</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(res.aov2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: enzyme
          Df Sum Sq Mean Sq F value    Pr(&gt;F)    
substrate  4 7083.7 1770.92  58.712 &lt; 2.2e-16 ***
bacillus   3 1833.5  611.17  20.263 7.869e-09 ***
Residuals 52 1568.5   30.16                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute two-way ANOVA test with interaction effect</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>res.aov3 <span class="ot">&lt;-</span> <span class="fu">aov</span>(enzyme <span class="sc">~</span> substrate <span class="sc">*</span> bacillus, <span class="at">data =</span> enzyme_df)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(res.aov3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: enzyme
                   Df Sum Sq Mean Sq F value    Pr(&gt;F)    
substrate           4 7083.7 1770.92 816.050 &lt; 2.2e-16 ***
bacillus            3 1833.5  611.17 281.632 &lt; 2.2e-16 ***
substrate:bacillus 12 1481.7  123.47  56.896 &lt; 2.2e-16 ***
Residuals          40   86.8    2.17                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><strong>Phân hạng</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">LSD.test</span>(res.aov2, <span class="fu">c</span>(<span class="st">"substrate"</span>, <span class="st">"bacillus"</span>), <span class="at">console =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Study: res.aov2 ~ c("substrate", "bacillus")

LSD t Test for enzyme 

Mean Square Error:  30.16264 

substrate:bacillus,  means and individual ( 95 %) CI

                   enzyme       std r       LCL      UCL     Min     Max
substrate_a:AB12 28.70833 3.2384490 3 22.345581 35.07109 26.4125 32.4125
substrate_a:CD47 31.67083 1.2577468 3 25.308081 38.03359 30.2250 32.5125
substrate_a:ER12 38.54167 2.1126972 3 32.178914 44.90442 36.1750 40.2375
substrate_a:MS16 34.91667 1.3123413 3 28.553914 41.27942 33.5375 36.1500
substrate_b:AB12 11.22083 2.0056301 3  4.858081 17.58359  8.9500 12.7500
substrate_b:CD47 10.14583 0.2905634 3  3.783081 16.50859  9.9250 10.4750
substrate_b:ER12 15.32083 0.6805711 3  8.958081 21.68359 14.7250 16.0625
substrate_b:MS16 18.87917 2.4626058 3 12.516414 25.24192 16.5250 21.4375
substrate_c:AB12 24.44583 1.3394456 3 18.083081 30.80859 23.2000 25.8625
substrate_c:CD47 17.70000 2.1391806 3 11.337248 24.06275 15.4625 19.7250
substrate_c:ER12 21.14167 0.8331354 3 14.778914 27.50442 20.1875 21.7250
substrate_c:MS16 25.78333 0.7496180 3 19.420581 32.14609 25.1875 26.6250
substrate_d:AB12 47.27500 1.1937991 3 40.912248 53.63775 45.9125 48.1375
substrate_d:CD47 24.79167 0.7073645 3 18.428914 31.15442 24.0625 25.4750
substrate_d:ER12 52.95417 0.3312697 3 46.591414 59.31692 52.5750 53.1875
substrate_d:MS16 42.43750 1.7193294 3 36.074748 48.80025 40.4625 43.6000
substrate_e:AB12 43.57083 1.1142776 3 37.208081 49.93359 42.3875 44.6000
substrate_e:CD47 22.12083 0.5511824 3 15.758081 28.48359 21.5500 22.6500
substrate_e:ER12 45.24167 0.4924958 3 38.878914 51.60442 44.7000 45.6625
substrate_e:MS16 52.78750 0.3269174 3 46.424748 59.15025 52.4125 53.0125

Alpha: 0.05 ; DF Error: 52
Critical Value of t: 2.006647 

least Significant Difference: 8.998291 

Treatments with the same letter are not significantly different.

                   enzyme groups
substrate_d:ER12 52.95417      a
substrate_e:MS16 52.78750      a
substrate_d:AB12 47.27500     ab
substrate_e:ER12 45.24167     ab
substrate_e:AB12 43.57083     bc
substrate_d:MS16 42.43750     bc
substrate_a:ER12 38.54167    bcd
substrate_a:MS16 34.91667    cde
substrate_a:CD47 31.67083    def
substrate_a:AB12 28.70833    efg
substrate_c:MS16 25.78333    fgh
substrate_d:CD47 24.79167    fgh
substrate_c:AB12 24.44583    fgh
substrate_e:CD47 22.12083    ghi
substrate_c:ER12 21.14167    ghi
substrate_b:MS16 18.87917    hij
substrate_c:CD47 17.70000    hij
substrate_b:ER12 15.32083     ij
substrate_b:AB12 11.22083      j
substrate_b:CD47 10.14583      j</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">duncan.test</span>(res.aov2, <span class="fu">c</span>(<span class="st">"substrate"</span>, <span class="st">"bacillus"</span>), <span class="at">console =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Study: res.aov2 ~ c("substrate", "bacillus")

Duncan's new multiple range test
for enzyme 

Mean Square Error:  30.16264 

substrate:bacillus,  means

                   enzyme       std r     Min     Max
substrate_a:AB12 28.70833 3.2384490 3 26.4125 32.4125
substrate_a:CD47 31.67083 1.2577468 3 30.2250 32.5125
substrate_a:ER12 38.54167 2.1126972 3 36.1750 40.2375
substrate_a:MS16 34.91667 1.3123413 3 33.5375 36.1500
substrate_b:AB12 11.22083 2.0056301 3  8.9500 12.7500
substrate_b:CD47 10.14583 0.2905634 3  9.9250 10.4750
substrate_b:ER12 15.32083 0.6805711 3 14.7250 16.0625
substrate_b:MS16 18.87917 2.4626058 3 16.5250 21.4375
substrate_c:AB12 24.44583 1.3394456 3 23.2000 25.8625
substrate_c:CD47 17.70000 2.1391806 3 15.4625 19.7250
substrate_c:ER12 21.14167 0.8331354 3 20.1875 21.7250
substrate_c:MS16 25.78333 0.7496180 3 25.1875 26.6250
substrate_d:AB12 47.27500 1.1937991 3 45.9125 48.1375
substrate_d:CD47 24.79167 0.7073645 3 24.0625 25.4750
substrate_d:ER12 52.95417 0.3312697 3 52.5750 53.1875
substrate_d:MS16 42.43750 1.7193294 3 40.4625 43.6000
substrate_e:AB12 43.57083 1.1142776 3 42.3875 44.6000
substrate_e:CD47 22.12083 0.5511824 3 21.5500 22.6500
substrate_e:ER12 45.24167 0.4924958 3 44.7000 45.6625
substrate_e:MS16 52.78750 0.3269174 3 52.4125 53.0125

Alpha: 0.05 ; DF Error: 52 

Critical Range
        2         3         4         5         6         7         8         9 
 8.998291  9.464564  9.771386  9.993980 10.164993 10.301439 10.413258 10.506735 
       10        11        12        13        14        15        16        17 
10.586085 10.654261 10.713409 10.765131 10.810657 10.850946 10.886760 10.918716 
       18        19        20 
10.947317 10.972979 10.996050 

Means with the same letter are not significantly different.

                   enzyme groups
substrate_d:ER12 52.95417      a
substrate_e:MS16 52.78750      a
substrate_d:AB12 47.27500     ab
substrate_e:ER12 45.24167     ab
substrate_e:AB12 43.57083    abc
substrate_d:MS16 42.43750     bc
substrate_a:ER12 38.54167    bcd
substrate_a:MS16 34.91667    cde
substrate_a:CD47 31.67083    def
substrate_a:AB12 28.70833    efg
substrate_c:MS16 25.78333   efgh
substrate_d:CD47 24.79167   fghi
substrate_c:AB12 24.44583   fghi
substrate_e:CD47 22.12083   fghi
substrate_c:ER12 21.14167   ghij
substrate_b:MS16 18.87917  ghijk
substrate_c:CD47 17.70000   hijk
substrate_b:ER12 15.32083    ijk
substrate_b:AB12 11.22083     jk
substrate_b:CD47 10.14583      k</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HSD.test</span>(res.aov2, <span class="fu">c</span>(<span class="st">"substrate"</span>, <span class="st">"bacillus"</span>), <span class="at">console =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Study: res.aov2 ~ c("substrate", "bacillus")

HSD Test for enzyme 

Mean Square Error:  30.16264 

substrate:bacillus,  means

                   enzyme       std r     Min     Max
substrate_a:AB12 28.70833 3.2384490 3 26.4125 32.4125
substrate_a:CD47 31.67083 1.2577468 3 30.2250 32.5125
substrate_a:ER12 38.54167 2.1126972 3 36.1750 40.2375
substrate_a:MS16 34.91667 1.3123413 3 33.5375 36.1500
substrate_b:AB12 11.22083 2.0056301 3  8.9500 12.7500
substrate_b:CD47 10.14583 0.2905634 3  9.9250 10.4750
substrate_b:ER12 15.32083 0.6805711 3 14.7250 16.0625
substrate_b:MS16 18.87917 2.4626058 3 16.5250 21.4375
substrate_c:AB12 24.44583 1.3394456 3 23.2000 25.8625
substrate_c:CD47 17.70000 2.1391806 3 15.4625 19.7250
substrate_c:ER12 21.14167 0.8331354 3 20.1875 21.7250
substrate_c:MS16 25.78333 0.7496180 3 25.1875 26.6250
substrate_d:AB12 47.27500 1.1937991 3 45.9125 48.1375
substrate_d:CD47 24.79167 0.7073645 3 24.0625 25.4750
substrate_d:ER12 52.95417 0.3312697 3 52.5750 53.1875
substrate_d:MS16 42.43750 1.7193294 3 40.4625 43.6000
substrate_e:AB12 43.57083 1.1142776 3 42.3875 44.6000
substrate_e:CD47 22.12083 0.5511824 3 21.5500 22.6500
substrate_e:ER12 45.24167 0.4924958 3 44.7000 45.6625
substrate_e:MS16 52.78750 0.3269174 3 52.4125 53.0125

Alpha: 0.05 ; DF Error: 52 
Critical Value of Studentized Range: 5.276872 

Minimun Significant Difference: 16.73211 

Treatments with the same letter are not significantly different.

                   enzyme groups
substrate_d:ER12 52.95417      a
substrate_e:MS16 52.78750      a
substrate_d:AB12 47.27500     ab
substrate_e:ER12 45.24167    abc
substrate_e:AB12 43.57083    abc
substrate_d:MS16 42.43750   abcd
substrate_a:ER12 38.54167  abcde
substrate_a:MS16 34.91667  bcdef
substrate_a:CD47 31.67083 bcdefg
substrate_a:AB12 28.70833  cdefg
substrate_c:MS16 25.78333  defgh
substrate_d:CD47 24.79167   efgh
substrate_c:AB12 24.44583   efgh
substrate_e:CD47 22.12083   efgh
substrate_c:ER12 21.14167    fgh
substrate_b:MS16 18.87917    fgh
substrate_c:CD47 17.70000     gh
substrate_b:ER12 15.32083     gh
substrate_b:AB12 11.22083      h
substrate_b:CD47 10.14583      h</code></pre>
</div>
</div>
<section id="tài-liệu-tham-khảo" class="level4" data-number="8.0.5.1">
<h4 data-number="8.0.5.1" class="anchored" data-anchor-id="tài-liệu-tham-khảo"><span class="header-section-number">8.0.5.1</span> Tài liệu tham khảo</h4>
<ol type="1">
<li><p><code>https://statsandr.com/blog/two-way-anova-in-r/</code></p></li>
<li><p><a href="https://www.youtube.com/watch?v=Ctx8CcJdOB4">Analysis of a Two-Factor Completely Randomized Design in R</a></p></li>
<li><p><a href="https://rpubs.com/Alema/1000582">Outliers detection in R</a></p></li>
<li><p><code>https://www.r-bloggers.com/2016/12/outlier-detection-and-treatment-with-r/</code></p></li>
<li><p><code>https://stats.stackexchange.com/questions/61055/r-how-to-interpret-the-qqplots-outlier-numbers</code></p></li>
<li><p><code>http://www.sthda.com/english/wiki/two-way-anova-test-in-r</code></p></li>
<li><p><code>https://stackoverflow.com/questions/43123462/how-to-obtain-rmse-out-of-lm-result</code></p></li>
<li><p><code>https://online.stat.psu.edu/stat501/lesson/2/2.6</code></p></li>
<li><p><code>https://rcompanion.org/handbook/G_14.html</code></p></li>
<li><p>RMSE (Root Mean Square Error) <code>https://agronomy4future.org/?p=15930</code></p></li>
<li><p><code>https://stats.stackexchange.com/questions/445200/coefficient-of-variation-for-beween-groups</code></p></li>
</ol>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-page-right">
  <div class="nav-page nav-page-previous">
      <a href="./huong-dan-phan-tich-t-test-trong-r.html" class="pagination-link" aria-label="<b>Hướng dẫn phân tích t-test trong R</b>">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title"><b>Hướng dẫn phân tích t-test trong R</b></span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./so-sanh-ket-qua-giua-parametric-va-non-parametric-anova.html" class="pagination-link" aria-label="<b>So sánh kết quả giữa phân tích parametric và non-parametric ANOVA</b>">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title"><b>So sánh kết quả giữa phân tích parametric và non-parametric ANOVA</b></span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>